-- ‚úÖ Full Script dengan Mob Vacuum, Notifier, Anti Knockback, Anti Stun, Auto Parry & Mobile UI
-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local StarterGui = game:GetService("StarterGui")

local player = Players.LocalPlayer

-- üîî Notifier Function
local function notify(msg)
    StarterGui:SetCore("SendNotification", {
        Title = "Script Notifier",
        Text = msg,
        Duration = 2,
    })
    print(msg)
end

-- Remotes
local remotes = ReplicatedStorage:WaitForChild("remotes")
local onHit = remotes:WaitForChild("onHit")
local abilityHit = remotes:WaitForChild("abilityHit")
local swing = remotes:WaitForChild("swing")
local useBuff = ReplicatedStorage.remotes:WaitForChild("useAbility")
local parryRemote = ReplicatedStorage.remotes:WaitForChild("parry")

-- Kirim request ke server (contoh buff)
useBuff:FireServer("LifeSteal1")

-- Pengaturan
local active = false
local instakill = false
local damagePerHit = 2
local behindDistance = -5
local heightOffset = 0
local maxDistance = 100
local lerpSpeed = 0.1

local godMode = true
local maxHealthValue = math.huge

-- Mob Vacuum
local vacuumActive = false
local vacuumRadius = 100
local vacuumMinDistance = 5
local vacuumSpeed = 0.2

-- SPEED BOOST
local speedBoost = false
local originalWalkSpeed = 16
local boostedWalkSpeed = 50
local speedJumpPower = 75
local originalJumpPower = 50

-- Auto Parry
local autoParry = false

-- Proteksi
local antiKnockback = true
local antiStun = true

-- Daftar musuh dikecualikan
local excludedEnemies = {
    ["Blender"] = true,
    ["Dummy"] = true,
}

--------------------------------------------------------
-- üöÄ FUNGSI: Speed Boost
--------------------------------------------------------
local function applySpeedBoost()
    local char = player.Character
    if not char then return end
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    if not humanoid then return end
    
    if speedBoost then
        if humanoid:GetAttribute("OriginalWalkSpeed") == nil then
            humanoid:SetAttribute("OriginalWalkSpeed", humanoid.WalkSpeed)
            humanoid:SetAttribute("OriginalJumpPower", humanoid.JumpPower)
        end
        humanoid.WalkSpeed = boostedWalkSpeed
        humanoid.JumpPower = speedJumpPower
    else
        humanoid.WalkSpeed = humanoid:GetAttribute("OriginalWalkSpeed") or originalWalkSpeed
        humanoid.JumpPower = humanoid:GetAttribute("OriginalJumpPower") or originalJumpPower
    end
end

local function toggleSpeedBoost()
    speedBoost = not speedBoost
    applySpeedBoost()
    notify(speedBoost and "üöÄ Speed Boost AKTIF (" .. boostedWalkSpeed .. ")" or "üê¢ Speed Boost NONAKTIF")
end

local function changeSpeedValue(increase)
    if increase then
        boostedWalkSpeed = math.min(boostedWalkSpeed + 10, 100)
    else
        boostedWalkSpeed = math.max(boostedWalkSpeed - 10, 20)
    end
    if speedBoost then
        applySpeedBoost()
    end
    notify("üèÉ‚Äç‚ôÇÔ∏è Kecepatan: " .. boostedWalkSpeed .. " studs/sec")
end

--------------------------------------------------------
-- üíé God Mode
--------------------------------------------------------
local function enableGodMode()
    local char = player.Character or player.CharacterAdded:Wait()
    local hum = char:WaitForChild("Humanoid")
    hum.MaxHealth = maxHealthValue
    hum.Health = maxHealthValue
    hum.HealthChanged:Connect(function()
        if godMode and hum.Health < hum.MaxHealth then
            hum.Health = hum.MaxHealth
        end
    end)
end

--------------------------------------------------------
-- üõ° Anti Knockback
--------------------------------------------------------
local function enableAntiKnockback()
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    hrp.ChildAdded:Connect(function(child)
        if antiKnockback and (child:IsA("BodyVelocity") or child:IsA("VectorForce") or child:IsA("LinearVelocity")) then
            child:Destroy()
            print("üö´ Knockback diblokir:", child.ClassName)
        end
    end)
end

--------------------------------------------------------
-- üö´ Anti Stun
--------------------------------------------------------
local function enableAntiStun()
    local char = player.Character or player.CharacterAdded:Wait()
    local hum = char:WaitForChild("Humanoid")

    hum:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
        if antiStun and hum.WalkSpeed == 0 then
            hum.WalkSpeed = originalWalkSpeed
            print("üö´ Stun WalkSpeed direset")
        end
    end)

    hum:GetPropertyChangedSignal("JumpPower"):Connect(function()
        if antiStun and hum.JumpPower == 0 then
            hum.JumpPower = originalJumpPower
            print("üö´ Stun JumpPower direset")
        end
    end)

    char.DescendantAdded:Connect(function(obj)
        if antiStun and obj.Name:lower():find("stun") then
            obj:Destroy()
            print("üö´ Efek stun dihancurkan:", obj.Name)
        end
    end)

    RunService.RenderStepped:Connect(function()
        if antiStun then
            for _, state in pairs(Enum.HumanoidStateType:GetEnumItems()) do
                hum:SetStateEnabled(state, true)
            end
        end
    end)
end

--------------------------------------------------------
-- ‚öî Fungsi Attack
--------------------------------------------------------
local function attackTarget(humanoid)
    if not humanoid or humanoid.Health <= 0 then return end
    local damage = instakill and math.huge or damagePerHit
    swing:FireServer()
    task.wait(0.05)
    onHit:FireServer(humanoid, damage)
    abilityHit:FireServer(humanoid, damage, {["burn"] = {["dur"] = 1}})
    print("‚öî Hit:", humanoid.Parent.Name, "| Damage:", damage, "| Sisa HP:", humanoid.Health)
end

-- KillAll
function killAll()
    for _,v in pairs(Workspace:GetChildren()) do
        local hum = v:FindFirstChildOfClass("Humanoid")
        local hrp = v:FindFirstChild("HumanoidRootPart")
        if hum and hrp and hum.Health > 0 and v ~= player.Character then
            if not excludedEnemies[v.Name] then
                attackTarget(hum)
            end
        end
    end
end

--------------------------------------------------------
-- HRP Getter
--------------------------------------------------------
local function getCharacterHRP()
    local char = player.Character or player.CharacterAdded:Wait()
    return char:WaitForChild("HumanoidRootPart")
end

-- Cari musuh terdekat
local function getNearestEnemy()
    local charHRP = getCharacterHRP()
    local nearest, nearestDist
    for _, obj in pairs(Workspace:GetChildren()) do
        local hum = obj:FindFirstChildOfClass("Humanoid")
        local hrp = obj:FindFirstChild("HumanoidRootPart")
        if hum and hrp and hum.Health > 0 and obj ~= player.Character then
            if not excludedEnemies[obj.Name] then
                local dist = (hrp.Position - charHRP.Position).Magnitude
                if not nearest or dist < nearestDist then
                    nearest, nearestDist = hrp, dist
                end
            end
        end
    end
    return nearest
end

--------------------------------------------------------
-- Auto Nempel Musuh
--------------------------------------------------------
RunService.RenderStepped:Connect(function()
    if not active then return end
    local charHRP = getCharacterHRP()
    local enemyHRP = getNearestEnemy()
    if charHRP and enemyHRP then
        local enemyLook = enemyHRP.CFrame.LookVector
        local targetPos = enemyHRP.Position + (enemyLook * behindDistance)
        targetPos = targetPos + Vector3.new(0, heightOffset, 0)
        local distance = (targetPos - charHRP.Position).Magnitude
        if distance <= maxDistance then
            local newPos = charHRP.Position:Lerp(targetPos, lerpSpeed)
            charHRP.CFrame = CFrame.new(newPos, Vector3.new(enemyHRP.Position.X, newPos.Y, enemyHRP.Position.Z))
        end
    end
end)

--------------------------------------------------------
-- Mob Vacuum
--------------------------------------------------------
RunService.RenderStepped:Connect(function()
    if not vacuumActive then return end
    local charHRP = getCharacterHRP()
    for _, obj in pairs(Workspace:GetChildren()) do
        local hum = obj:FindFirstChildOfClass("Humanoid")
        local hrp = obj:FindFirstChild("HumanoidRootPart")
        if hum and hrp and hum.Health > 0 and obj ~= player.Character then
            if not excludedEnemies[obj.Name] then
                local dist = (hrp.Position - charHRP.Position).Magnitude
                if dist <= vacuumRadius and dist > vacuumMinDistance then
                    local newPos = hrp.Position:Lerp(charHRP.Position, vacuumSpeed)
                    hrp.CFrame = CFrame.new(newPos.X, charHRP.Position.Y, newPos.Z)
                    hum.AutoRotate = false
                end
            end
        end
    end
end)

--------------------------------------------------------
-- Auto Parry
--------------------------------------------------------
RunService.RenderStepped:Connect(function()
    if autoParry and parryRemote then
        pcall(function()
            parryRemote:FireServer()
        end)
    end
end)

--------------------------------------------------------
-- Aktifkan saat spawn
--------------------------------------------------------
player.CharacterAdded:Connect(function()
    task.wait(1)
    if godMode then enableGodMode() end
    enableAntiKnockback()
    enableAntiStun()
    if speedBoost then applySpeedBoost() end
end)

if player.Character then
    if godMode then enableGodMode() end
    enableAntiKnockback()
    enableAntiStun()
    if speedBoost then applySpeedBoost() end
end

--------------------------------------------------------
-- üéπ Hotkeys PC
--------------------------------------------------------
UIS.InputBegan:Connect(function(input, gpe)
    if gpe then return end

    if input.KeyCode == Enum.KeyCode.T then
        active = not active
        notify(active and "üéØ Auto Nempel AKTIF" or "üõë Auto Nempel MATI")
    elseif input.KeyCode == Enum.KeyCode.G then
        godMode = not godMode
        notify(godMode and "üíé God Mode ON" or "‚ùå God Mode OFF")
        if godMode then enableGodMode() end
    elseif input.KeyCode == Enum.KeyCode.Z then
        notify("üöÄ KillAll manual dijalankan...")
        killAll()
    elseif input.KeyCode == Enum.KeyCode.K then
        instakill = not instakill
        notify(instakill and "‚ò† Instakill Mode ON" or "‚öî Normal Damage Mode ON")
    elseif input.KeyCode == Enum.KeyCode.V then
        vacuumActive = not vacuumActive
        notify(vacuumActive and "üåÄ Mob Vacuum AKTIF" or "‚ùå Mob Vacuum MATI")
    elseif input.KeyCode == Enum.KeyCode.P then
        toggleSpeedBoost()
    elseif input.KeyCode == Enum.KeyCode.Equals then
        changeSpeedValue(true)
    elseif input.KeyCode == Enum.KeyCode.Minus then
        changeSpeedValue(false)
    elseif input.KeyCode == Enum.KeyCode.N then
        autoParry = not autoParry
        notify(autoParry and "‚ö° Auto Parry AKTIF" or "‚ùå Auto Parry MATI")
    elseif input.KeyCode == Enum.KeyCode.B then
        antiKnockback = not antiKnockback
        antiStun = not antiStun
        notify((antiKnockback and antiStun) and "üõ° Proteksi ON" or "‚ùå Proteksi OFF")
    end
end)

--------------------------------------------------------
-- üì± MOBILE UI TOGGLE
--------------------------------------------------------
local screenGui = Instance.new("ScreenGui", player.PlayerGui)
screenGui.Name = "MobileController"

-- Frame menu
local menuFrame = Instance.new("Frame")
menuFrame.Size = UDim2.new(0, 300, 0, 200)
menuFrame.Position = UDim2.new(1, -320, 1, -220)
menuFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
menuFrame.BackgroundTransparency = 0.2
menuFrame.Visible = false
menuFrame.Parent = screenGui

-- Tombol toggle
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 50, 0, 50)
toggleBtn.Position = UDim2.new(1, -60, 1, -60)
toggleBtn.Text = "‚â°"
toggleBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Parent = screenGui

local menuOpen = false
toggleBtn.MouseButton1Click:Connect(function()
    menuOpen = not menuOpen
    menuFrame.Visible = menuOpen
    toggleBtn.Text = menuOpen and "‚úï" or "‚â°"
end)

-- Fungsi buat tombol menu
local function createMenuButton(name, text, pos, callback)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Text = text
    btn.Size = UDim2.new(0, 120, 0, 40)
    btn.Position = pos
    btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Parent = menuFrame
    btn.MouseButton1Click:Connect(callback)
    return btn
end

-- Tombol menu mobile
createMenuButton("AutoNempel", "üéØ Auto Nempel", UDim2.new(0, 10, 0, 10), function()
    active = not active
    notify(active and "üéØ Auto Nempel AKTIF" or "üõë Auto Nempel MATI")
end)

createMenuButton("KillAll", "‚ò† KillAll", UDim2.new(0, 150, 0, 10), function()
    notify("üöÄ KillAll manual dijalankan...")
    killAll()
end)

createMenuButton("GodMode", "üíé GodMode", UDim2.new(0, 10, 0, 60), function()
    godMode = not godMode
    notify(godMode and "üíé God Mode ON" or "‚ùå God Mode OFF")
    if godMode then enableGodMode() end
end)

createMenuButton("Instakill", "‚ò† Instakill", UDim2.new(0, 150, 0, 60), function()
    instakill = not instakill
    notify(instakill and "‚ò† Instakill Mode ON" or "‚öî Normal Damage Mode ON")
end)

createMenuButton("Vacuum", "üåÄ Vacuum", UDim2.new(0, 10, 0, 110), function()
    vacuumActive = not vacuumActive
    notify(vacuumActive and "üåÄ Mob Vacuum AKTIF" or "‚ùå Mob Vacuum MATI")
end)

createMenuButton("Parry", "‚ö° Auto Parry", UDim2.new(0, 150, 0, 110), function()
    autoParry = not autoParry
    notify(autoParry and "‚ö° Auto Parry AKTIF" or "‚ùå Auto Parry MATI")
end)

createMenuButton("Speed", "üöÄ Speed", UDim2.new(0, 10, 0, 160), function()
    toggleSpeedBoost()
end)

createMenuButton("Proteksi", "üõ° Proteksi", UDim2.new(0, 150, 0, 160), function()
    antiKnockback = not antiKnockback
    antiStun = not antiStun
    notify((antiKnockback and antiStun) and "üõ° Proteksi ON" or "‚ùå Proteksi OFF")
end)

--------------------------------------------------------
-- ‚úÖ Info Awal
--------------------------------------------------------
notify("‚úÖ Script siap. PC: [T]=AutoNempel, [Z]=KillAll, [G]=GodMode, [K]=Instakill, [V]=Vacuum, [N]=Auto Parry, [B]=Proteksi, [P]=SpeedBoost. Mobile: pakai menu ‚â°")
